/* Theme-aware backgrounds for the service map */
.star-field-container {
  position: relative;
  border-radius: 6px;
  overflow: hidden;
}

/* Dark theme: Star field effect */
[data-theme='dark'] .star-field-container,
.star-field-container[data-dark-theme='true'] {
  background: linear-gradient(135deg, #0a0e27 0%, #1a1a2e 50%, #16213e 100%);
}

/* Light theme: Light grey background */
[data-theme='light'] .star-field-container,
.star-field-container[data-dark-theme='false'] {
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #f5f5f5 100%);
}

/* Default fallback for dark theme */
.star-field-container {
  background: linear-gradient(135deg, #0a0e27 0%, #1a1a2e 50%, #16213e 100%);
}

.star-field-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  /* Default stars for dark theme */
  background-image: 
    radial-gradient(2px 2px at 20px 30px, #ffffff, transparent),
    radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
    radial-gradient(1px 1px at 90px 40px, #ffffff, transparent),
    radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
    radial-gradient(2px 2px at 160px 30px, #ffffff, transparent);
  background-repeat: repeat;
  background-size: 200px 100px;
  opacity: 0.3;
  animation: twinkle 4s ease-in-out infinite alternate;
}

/* Stars explicitly show in dark theme */
[data-theme='dark'] .star-field-container::before,
.star-field-container[data-dark-theme='true']::before {
  background-image: 
    radial-gradient(2px 2px at 20px 30px, #ffffff, transparent),
    radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
    radial-gradient(1px 1px at 90px 40px, #ffffff, transparent),
    radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
    radial-gradient(2px 2px at 160px 30px, #ffffff, transparent);
  background-repeat: repeat;
  background-size: 200px 100px;
  opacity: 0.3;
  animation: twinkle 4s ease-in-out infinite alternate;
}

/* Light theme: override with subtle pattern instead of stars */
[data-theme='light'] .star-field-container::before,
.star-field-container[data-dark-theme='false']::before {
  background-image: 
    radial-gradient(1px 1px at 50px 50px, rgba(0,0,0,0.05), transparent),
    radial-gradient(1px 1px at 100px 25px, rgba(0,0,0,0.03), transparent),
    radial-gradient(1px 1px at 150px 75px, rgba(0,0,0,0.04), transparent) !important;
  background-repeat: repeat;
  background-size: 200px 100px;
  opacity: 0.4 !important;
  animation: none !important;
}

@keyframes twinkle {
  0% { opacity: 0.3; }
  100% { opacity: 0.6; }
}

/* Pulsing animation keyframes - contained within node boundaries */
@keyframes pulseWarning {
  0% {
    box-shadow: 0 0 0 0 rgba(250, 173, 20, 0.8);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 0 8px rgba(250, 173, 20, 0.6);
    transform: scale(1.06);
  }
  100% {
    box-shadow: 0 0 0 16px rgba(250, 173, 20, 0);
    transform: scale(1);
  }
}

@keyframes pulseCritical {
  0% {
    box-shadow: 0 0 0 0 rgba(255, 77, 79, 0.8);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 0 8px rgba(255, 77, 79, 0.6);
    transform: scale(1.06);
  }
  100% {
    box-shadow: 0 0 0 16px rgba(255, 77, 79, 0);
    transform: scale(1);
  }
}

@keyframes pulseFatal {
  0% {
    box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.8);
    transform: scale(1);
  }
  25% {
    box-shadow: 0 0 0 8px rgba(255, 0, 0, 0.7);
    transform: scale(1.06);
  }
  50% {
    box-shadow: 0 0 0 12px rgba(255, 255, 255, 0.4);
    transform: scale(1.06);
  }
  75% {
    box-shadow: 0 0 0 8px rgba(255, 0, 0, 0.7);
    transform: scale(1.06);
  }
  100% {
    box-shadow: 0 0 0 16px rgba(0, 0, 0, 0);
    transform: scale(1);
  }
}

/* Enhanced node styling with pulsing for alert nodes */
.vis-network .vis-node {
  transition: all 0.2s ease;
}

/* Pulsing shadow effects for different alert severities */
[data-dark-theme='true'] .enhanced-graph-container .vis-network canvas,
[data-dark-theme='false'] .enhanced-graph-container .vis-network canvas {
  filter: none;
}

/* Try direct animation on vis-network elements */
.vis-network svg .vis-node {
  transition: filter 0.3s ease;
}

/* This might work if vis-network uses SVG */
.enhanced-graph-container[data-has-alerts='true'] .vis-network svg .vis-node[fill='#ff4d4f'],
.enhanced-graph-container[data-has-alerts='true'] .vis-network svg .vis-node[fill='#faad14'],
.enhanced-graph-container[data-has-alerts='true'] .vis-network svg .vis-node[fill='#000000'],
.enhanced-graph-container[data-has-alerts='true'] .vis-network svg .vis-node[fill='#8c8c8c'] {
  animation: nodePulse 2s ease-in-out infinite;
}

@keyframes nodePulse {
  0% { filter: drop-shadow(0 0 3px currentColor); }
  50% { filter: drop-shadow(0 0 12px currentColor); }
  100% { filter: drop-shadow(0 0 3px currentColor); }
}

/* Enhanced styling for the graph container */
.enhanced-graph-container {
  position: relative;
  border: 1px solid #d9d9d9;
  border-radius: 6px;
  overflow: hidden;
}

/* Dark theme background */
[data-theme='dark'] .enhanced-graph-container,
.enhanced-graph-container[data-dark-theme='true'] {
  background: linear-gradient(135deg, #0a0e27 0%, #1a1a2e 50%, #16213e 100%);
}

/* Light theme background */
[data-theme='light'] .enhanced-graph-container,
.enhanced-graph-container[data-dark-theme='false'] {
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #f5f5f5 100%);
}

/* Default fallback for dark theme */
.enhanced-graph-container:not([data-dark-theme]) {
  background: linear-gradient(135deg, #0a0e27 0%, #1a1a2e 50%, #16213e 100%);
}

.enhanced-graph-container .vis-network {
  background: transparent !important;
}

/* Subtle glow effect for healthy services to make them look like distant stars */
.vis-network .vis-node.healthy-service {
  filter: drop-shadow(0 0 2px rgba(82, 196, 26, 0.5));
}

/* Focus mode adjustments - slower pulse rates */
.focus-mode .pulse-overlay.alert-warning {
  animation: pulseWarning 3s ease-in-out infinite;
}

.focus-mode .pulse-overlay.alert-critical {
  animation: pulseCritical 2.5s ease-in-out infinite;
}

.focus-mode .pulse-overlay.alert-fatal {
  animation: pulseFatal 1.2s ease-in-out infinite;
}

/* Namespace nodes get a subtle grey glow */
.vis-network .vis-node.namespace-node {
  filter: drop-shadow(0 0 3px rgba(140, 140, 140, 0.4));
}

/* Enhanced edge styling - theme aware */
[data-theme='dark'] .star-field-container .vis-network .vis-edge,
.star-field-container[data-dark-theme='true'] .vis-network .vis-edge {
  opacity: 0.7;
}

[data-theme='light'] .star-field-container .vis-network .vis-edge,
.star-field-container[data-dark-theme='false'] .vis-network .vis-edge {
  opacity: 0.8;
}

.star-field-container .vis-network .vis-edge:hover {
  opacity: 1;
}